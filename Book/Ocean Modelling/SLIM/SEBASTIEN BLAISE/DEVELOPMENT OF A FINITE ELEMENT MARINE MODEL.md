#[SLIM博士论文] DEVELOPMENT OF A FINITE ELEMENT MARINE MODEL
> SEBASTIEN BLAISE
> Louvain-la-Neuve, Novembre 2009

#简介

地球表面的70％被海洋覆盖，其中蕴含了地球上97％的水分。全球大约一半的人口居住在沿海地区，海洋生态系统与人类活动联系紧密。它们是多种资源提供者（食品，旅游，...），但也被用来当作废物处理的区域。作为地球上99％生命的栖息地，海洋在地球生态系统中作用举足轻重。水污染是他们不可逆退化的主要原因之一（Ellis, 2000; Rajaram and Das, 2008; Camargo and lvaro Alonso, 2006），但水动力也在海洋的变化中发挥了巨大的作用。流体速度和紊动显著影响水体中泥沙的结构，侵蚀与沉积。风和洋流使得从海底营养丰富的水上升到表面，促使浮游生物大量繁殖（图1）。这些现象影响了当地的动植物及其再分配（As- mus et al., 2007）。例如，Riisgard等（2007）观察，在Odense峡湾（丹麦）由于重悬浮使浮游植物和滤食性物种，由两个因素划分其寿命。 幼虫和卵也直接由局部和大型循环水距离长达数百公里进行。这些修饰在个体或物种水平可导致与其它物理参数或物种间动作（Asmus et al., 2007）。

虽然自然过程对海洋生态系统的物理性质产生影响，但人类产生的影响也是不可否认和多种多样的。工业排放，城市化和农业等等水污染（Ellis, 2000; Rajaram and Das, 2008; Tuncer et al., 1998）。人类引起的气候变化对水性质的影响，如温度，循环模式和海平面（Lewsey et al., 2004; Munday et al., 2009）。人类活动也会直接影响水动力性质，如通过疏浚等海底地形变化，开垦土地（Gong et al., 2008）或建设河口上游水坝等（Kim et al., 2006; lun Yang et al., 2002）。

以目前的发展水平，避免人类活动影响海洋水动力过程，形态和生态系统是不可能的。然而，丰富的海洋系统的知识可以减少这种影响，或通过不同的方式限制其产生的有害的后果：

* 预测开发项目的影响（发电，沿海的工程等），以选择最安全的方案。
* 确认的一些因素有对生态系统不会产生有害影响，并且制定其补救技术。
* 帮助量化生态系统的经济价值来影响政策决定（Chee, 2004）。

尽管海洋系统的知识可以由观测获得，但后者通常非常昂贵，并且可能需要水的性质的改变（释放示踪粒子进行跟踪）。另外，这些观察无法预测对海洋改造的后果（排放污染物，改变地形等）。缩小比例的模型可以提供关于不同的方案的影响的信息，但这类模型需要进行长期而且复杂的构建。必须遵循物理相似的原则，但有时会导致变态比尺（Hughes, 1993）。它们或许过于简单考虑流动形式的复杂性，导致其结果可能难以观察和解释。另一个解决方案是使用数值模型模拟海洋系统。一旦模型校准好，可以模拟许多不同的过程，仅仅由计算成本所限制。这些模型可以进行敏感性分析或预测不同的方案在海洋系统的影响（如人类活动，示踪物排放，补救方案等）。模型是了解该系统对任何扰动响应的交互方式。此外，模型输出定义在整个领域，这使得他们的解释或者计算诊断变量更容易。他们需要的数据集（如盐度，温度，水深等），它可以从现场调查获得（Wolanski et al., 1996），卫星数据（Egbert et al., 1994）或其他模型。

数值模型被用来模拟所关注的域中的特定的区域（局部或区域模型）或覆盖全球海洋模型（全球模式）。由于计算时间的限制，模型的分辨率不能够描述考虑区域内全部尺度的现象，例如海洋中的特征尺寸在1毫米至1万公里之间变化（图2）。区域模型可以描述由几十米开始的不同分辨率。全球海洋模型一般过于粗糙明确表示尺度涡旋。高分辨率模型（网格大小为10km数量级）能够描述这些漩涡，但没有电脑能够进行几百到几千年时间长度的模拟以研究地球气候变化。在过去的十年中，海气耦合模式在海洋模拟的水平分辨率已经从300公里减小到1998年的25公里，其运行采用英国研究机构的新型超级计算机HECTOR（Slingo et al., 2009）。虽然小与计算域相比，尚未解决的过程中可能有过的大尺度结构这是明确地表示（Griffies，2004年），具有关键性的影响。一些的参数化，从物理方面的考虑而设计，需要开发借此效应考虑在内（例如，湍流可通过扩散算子（Burchard，2002）的装置进行参数设置）。不同的参数设置必须为每个许多悬而未决的物理过程进行开发，因为这些过程的影响differ- ently规模较大的特性。本论文的主要部分是相关的未解决的物理治疗。未解决的现象可以重新迟来到整个域中，或者特别靠近一些界限。在后一种情况下，它们被称为“边界层”，其中一些物理变量的差异，各个比其在平均流动变化更陡峭。当涉及到边界层，该数值表示也可被改进，以处理该变量的陡峭变化而不网格细化（Hanert等人，2007）。在这种情况下，没有参数化是必要的。另一种类型的未解决的物理涉及无法表示的现象，由于该模型，如：对三维限制二维现象的一维模型。在某些情况下，它可以是有理由参数化这些现象，以获得在一个简单的模型有用的结果。

数值海洋模型已经广泛开发在近几年。从单一学科研究的范围增加，如hydrody-动力学性能耦合物理-化学-生物生态系统建模。然而，许多这样的模型仍然使用相同的基本数值方法：有限差分法。作为实现方法简单，这种方法置被限制在结构化网格中使用。这意味着这种模式的几个限制。海岸线只能使用一个阶梯表示，其诱导杂散涡和混合限定（Dupont et al., 2003）。网格分辨率不能在计算域中变化。整个计算域网格分辨率必须比在我们感兴趣现象的特征长度更小。但是，在一个有限区域内，使用变化网格精度更加有效。嵌套网格提供灵活可变的分辨率。它包含一个较高的分辨率网格嵌套在低分辨率网格内。然而信息在不同尺度网格之间的传递是有问题的。网格之间的插值必须确保质量守恒，不能产生数值振荡波或反射，这些要求很难满足（Debreu and Blayo, 2008）。非结构化网格是一种替代嵌套的网格模型。信息从一个区域到另一个的一个区域传输时无需进行内插。此外，这种方法可以避免波反射问题，如果由细到粗分辨率的过渡是足够光滑。证明非结构网格的潜力的一个例子是大堡礁，一组位于澳大东北部大陆架附近超过2500个珊瑚礁。当地数据和模拟显示，小尺度的现象主要出现在小礁石，岛屿和通道附近（Lambrechts et al., 2008b）。一个强大的方法数值来模拟流程细化接近这些地形特征的分辨率，而主要的分辨率是粗糙的。这种方法已被使用，依靠非结构网格（Figure 3），通过Lambrechts et al. (2008b)谁计算流体力学在整个大堡礁。在这方面，一些措施之，都是为建立非结构网格的平面或球形地球物理模拟（Lambrechts et al., 2008a）。在全球范围内的模型，非结构化的网格是代表尺度涡存在于全球海洋的相对小部分是有用的，但包含了世界海洋的动能显著的一部分。

有多种方法可以处理非结构化网格，包括近岸与全球尺度应用。有限体积法模型如FVCOM，有着很大的用户群体。有限单元法，第一模型采用的是速度与水位的线性连续单元（Lynch et al.,
1996），通过求解自由面波动方程来避免振荡（？），但是这会导致质量不守恒。使用$P_1^{NC}P_1$，流速采用逐段线性不相容基函数$P_i^{NC}$，水位采用线性相容基函数$P_1$，可以避免流速和水位的高阶振荡，并且成功用在三维浅水模型中（White et al., 2008a）。采用$P_1^DG-P_2$（Cotter et al., 2009）与$P_1^NC-P_1^NC$（Comblen et al., 2009b）组合方法仍在研究之中。对大尺度海洋模型，FEOM采用连续有限元方法（Wang et al., 2008a,b; Timmermann et al., 2009），ICOM采用自适应方法来捕捉不同尺度流体特征。谱元方法在边界不规则时会产生数值振荡。

有限体积方法非常适合对流为主的流体运动模拟，但是其限制是精度较低。与其不同的是，有限单元法可以灵活地采用基函数，允许采用较高精度来表示计算结果；但是其只适合扩散问题，在对流为主的运动种需要一些方法使格式稳定。


该论文的第一章介绍了三维间断有限元海洋模型开发。展示和讨论了斜压模拟的一些结果。本文的其余部分是专门讨论海洋模型中不同类型的未解决的物理学问题。第二章介绍两种不同的边界层出现在海洋建模：相关的流体力学底部速度边界层，和中的停留时间，这是一种诊断可变边界层。这两个参数设置和表示使用扩展的有限元方法进行讨论和比较。在一维斜压模型的密度梯度的参得到更好地。在第3章的要点是参数化，这是不该模型的三维空间的现象。该注意的是，以不同的物理条件下的参数化的稳定性。第4章涉及亚格子湍流模型中的三维模型，并且比较了不同的参数化对周围浅水岛流的逼真模拟的效果。

这项工作是SLIM项目一部分，旨在建立一个三维非结构化目，有限元海冰 - 海洋模型的范围内进行的。在这种模式下的发展框架，本文亲志愿组织切实可行的解决方案涉及到出现在马海相模拟各种数值的问题。由于不同的替代方法存在，我们试图找出优势，这些替代品的优缺点，以帮助用适当的方法选择一个特定的配置。海洋建模是一个活跃的研究课题，特别是由于新车型纷纷亮相，重新趴在非结构网格。这里介绍的工作适合这种演进，并试图帮助改善海洋过程的代表性和理解。有些发展都进行了TIMOTHY2项目的主持下进行。它的主要目标是开发，验证和应用工具来描述和评价的地表水，地下水和马海相水域水质变化。在这个角度来看，开发的工具应用到现实领域，这证实了其适用于真正的配置。


#1. 三维DG斜压模型

本章的重点是海洋模型应该能够处理问题，从局部区域扩展到全球范围内的模拟。只考虑静压的Boussinesq方程。描述一种新型的模式分裂程序，采用隐式方法处理快速表面重力波。

##1.1 控制方程

大尺度海洋模式通常可以解决的静水Boussinesq方程。质量守恒退化成体积守恒，并且密度变化只考虑在压力梯度项中。静压假定使垂直动量方程简化为压力梯度和重力之间的平衡形式。本节详细的介绍此方程组，并强调了需要处理的关键点。

**1.1 控制方程**

该Boussinesq方程的符号如下（详细信息请参见表1.1）：

* 水平动量方程
$$\frac{\partial \mathbf{u}}{\partial t}+\triangledown_h \cdot (\mathbf{u} \mathbf{u}) + \frac{\partial(w\mathbf{u})}{\partial z}+f\mathbf{e_z}\wedge \mathbf{u}+ \frac{1}{\rho_0}\triangledown_h p+ g\triangledown_h \eta=\triangledown_h \cdot (\nu_h \triangledown_h \mathbf{u}) +\frac{\partial}{\partial z}(\nu_v \frac{\mathbf{u}}{\partial z})$$

* 连续方程
$$\triangledown_h \cdot \mathbf{u} + \frac{w}{z} = 0$$

* 自由表面方程
$$\frac{\partial \eta}{\partial t} + \triangledown_h \cdot \int^\eta_{-h}\mathbf{u}dz = 0$$

* 标量对流扩散方程
$$\frac{\partial c}{\partial t}+\triangledown_h \cdot (\mathbf{u}c)+\frac{\partial wc}{\partial z} = \triangledown_h\cdot(\kappa_h\triangledown_h c)+\frac{\partial}{\partial z}(\kappa_v \frac{\partial c}{\partial z})$$

* 斜压方程
$$\frac{\partial p}{\partial z} = -g\rho(T,S) \quad \textrm{with} \quad \rho = \rho_0 + \rho'(T,S)$$

在斜压方程是由垂向动量方程简化而来。这个方程组是混合形式。垂向积分后，它简化为浅水方程，是双曲线和抛物线形式，但与双曲部分仍占主导（？）。

动量系统可以被看作是层叠浅水方程组。这些层之间的耦合只由垂向对流和扩散完成。在无粘条件下，不可渗边界条件不能强加于侧边界，因为动量方程是双曲线形式，必须确定进入的特征线（Rousseau et al., 2004）。

垂直速度不从动量方程推导出，而是从不可压方程从底部到顶部积分获得。密度差$\rho'$是由温度和盐度根据状态方程推导。

粘性及扩散系数被用来代替许多非解析的物理过程所产生效果。一些耗散也由数值格式生成的。总的混合是则数值混合并且被显式地添加的耗散的总和。然而，这个数值引起的混合应是足够小得，并且应该是仅存在与需要的地方，以便保持模型稳定。重要的是，数值耗散的程度不能超过基于物理过程的混合。不幸的是，后者的要求在许多海洋模式没有满足。模型中数值耗散程度是可以量化的（Burchard和Rennau，2008年），并且这样的技术应该被应用到SLIM模型及后续的研究中，以确定附加的扩散必须被添加到代表的非解析的现象的影响中。

粘度及扩散是强各向异性的（Griffies，2004）。如果我们只考虑在垂直方向分层的流体，层化抑制沿垂向任何运动。其结果是，许多运输过程往往可以更有效地沿等密度的表面扩散（水平方向）而不跨过等密度面（垂直方向）。Ledwell等（1993）在海洋中测量示踪剂扩散现象表明，在较大的尺度上（几百公里数量级），水平和垂直的混合之间的比率可高达8个数量级。特别要注意确保各向异性扩散形式的稳定性和准确性，如第1.6节中所述。亚格子现象在水平或垂直方向是完全不同。垂直过程包括小规模（从几毫米到几米）的振荡，主要由剪切不稳定性和地球重力不稳定性产生。由于其尺度非常小，这些过程都未曾在海洋模型中解析。水平主导亚格子过程对应较大的运动的尺度，如尺度涡（几十到几百公里）。在这种情况下，较大的现象都可以由模型来解决，这取决于分辨率，并且涡流扩散性必须与网格尺度增加。

##1.2 时间离散

###1.2.1 模式分离过程

明确的方法对时间步长相关的，以最快的传播现象稳定性约束。在静水的Boussinesq系统，表面引力波是最快的现象，以及相关的稳定的时间段是如此之小，长期完全明确的模拟需要由太多的迭代。但是，我们没有能力解决隐含整个耦合方程。所得到的体系的尺寸是如此之大，存储器的要求是负担不起的。

**1.2 时间离散**

一个有效的策略来解决隐含的自由表面是解决相应的全球系统的舒尔补较小的系统。如果对应于公式（1.1）和（1.3）的线性离散系统读取：

其中，Mu，Mη，Xu，Xη分别为质量矩阵和的速度和高度自由度的载体。 G和D分别对应分别tively到的海拔梯度项（1.1）和速度散度项（1.3），而富和Fη是他们的右击 - 手 - 边。得到的等效小系统的高程在系统的最后一行代许：

这种方法是在Dukowicz和Smith（1994），以及在Marshall等发现。 （1997年）的全球规模的模式，而且在希拉尔等。 （2003）在球体浅水问题。对于这种方法是艾菲cient，大众矩阵速度沐必须易于可逆的，因此对角或块对角。对于连续有限元，质量结块必须执行这样的方法来应用。如果有些差异隐含的运营商加入到慕，其反转可能会变得困难。

有限元海洋模式FEOM采用了类似的方法（王，2007）。自由曲面方程的半离散隐形式（1.3）

其中，Δt为时间步长，而n和n+1分别以时间离散的旧的和新的时代相对应。如果我们考虑到只有海拔坡度是隐含在等式（1.1），新速度未+ 1使用确定

其中，包括明确的条款。这种表达可以在被取代
（1.8），以获得一个隐含的自由面：

方程（1.11）是首先需要解决，以获得U *。然后，隐式自由表面能通过解方程（1.13）来推断。最后，将速度从获得方程（1.12）。隐式垂直粘度忽略的校正步骤。所需要的是能够执行托换，将获得（1.13）。然后，速度可以通过求解方程（1.9）而获得。替代的方法类似于使用Dukowicz和史密斯的Schur补的方法（1994年），但取代是在连续空间而非执行在离散的级别。推理在不断的世界是如此的逆大众矩阵M-1在什么对应于舒尔消失完井ü换货;和离散操作者是不一样的。

通常是由海洋模式进行的另一种方法是模分裂。实际上，自由表面进化仅取决于深度集成veloc-伊蒂埃斯，但不能在三维场的细节。因此，ver-角度讲均方程被用来推断使用小时间步海面高程演化和灰，而三维斜压模式是使用较大的时间步演变而来。三维速度一般都校正，以使得它们的平均匹配正压模式的速度后验（Blumberg的和梅勒，1987;加德，1978）。正压模式也可以是时间阶梯隐式，使用相同的时间步作为斜压模式。模式分割方法的优点是，该正压模式对应的注册表众所周知的浅水方程。其离散和接口磁通量的表达顷稳定和验证（Comblen等人，2009年b）。我们选择使用这种方法，与斜压模式（显性）和正压模式（隐含的），同时一步。

二维浅水动量方程是深度集成方程1.1的结果。它被示于附录A，这深度集成可以总结了三维离散系统矩阵和向量，其对应的节点共享相同的垂直的线和列来获得。然后，我们通过离散地添加所有立体捐款到自由的对应二维度导出正压方程式。我们忽略隐垂直对流和在正压模式，即引入小水平耦联动量垂直扩散由于非对角质量矩阵。另外，也可以在正压模式明确地对待这些术语，并获得类似于通过王（2007）进行的近似。深度平均三维速度和二维速度之间的同一性利用拉格朗日乘数中的三维系统被执行。最好是使用拉格朗日乘子比后验校正速度，因为这校正考虑到如科里奥利隐含处理的条件。这些拉格朗日乘数的效果是纠正偏差，由于不同的处理，在斜压和正压模式垂直条款。校正不是最佳的，因为用于拉格朗日乘数校正的有限元空间（表面术语;恒定的垂​​直）比用于垂直动力学术语（体积术语与在水平面上接口方面的空间较小;变沿垂直）。然而，在斜压模式与正压模式一致，质量守恒保证。

###1.2.2 全部时间离散

我们使用隐式/显式龙格 - 库塔时间推进计划（Ascher的等人，1997年），其中刚性线性项是隐式处理，而非线性项明确处理。对于动力和自由面方程，表面重力波，垂直平流，垂直扩散，而科氏相关的条款是隐式处理，而平流和扩散是明确的。由此产生的线性Ocean系统要解决的就是块，每个块则对应的以棱镜列。它是那么没有必要建立一个立体的世界矩阵，内存使用量高度降低。平行缩放是强如每一块系统独立解决。示踪剂是充分的隐含，以避免对时间步骤的限制由于大示踪剂扩散性。不同方程求解在由以下序列所限定的顺序中的每个龙格 - 库塔子时间步：

1. 计算二维和三维模式中公共项
2. 解决二维模式以获得$\mathbf{U}$和$\eta$
3. 对于棱柱的每列
（a）计算三维动量方程中的隐式项
（b）计算分层流速$\mathbf{u}$其平均值为$\mathbf{U}$
（c）解决相关局部线性方程组，使用直接稀疏解算器，以获得$\mathbf{u}$
4. 解决不可压缩性方程，获得$w$
5. 对于每个标量
（a）计算的方程中每一项
（b）求解线性方程组
6. 计算密度场$\rho$
7. 计算斜压压力梯度以获得$\triangledown_h p$

##1.3 弱解形式与空间离散

###1.3.2 动量方程

**Lagrange余数法保证2维流速与3维流速相容**

为了保证二维与三维流速场有相同的平均流速，使用Lagrange余数作为虚拟力强迫将三维流速投影到右侧均值空间上。我们定义二维Lagrange余数 $\lambda$ 与二维流速分布在相同的有限单元空间内。

然后我们将棱柱的自由度添加到线性方程组中

##1.4 边界条件
##1.5 垂向坐标与其影响
##1.6 各向异性扩散处理
##1.7 密度驱动流
##1.8 DOME测试算例
##1.9 斜压不稳定性
##1.10 讨论